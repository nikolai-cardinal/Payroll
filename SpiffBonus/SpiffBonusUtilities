/**
 * Cardinal Payroll System - Spiff/Bonus Utilities
 * Contains general helper functions used by the Spiff/Bonus logic.
 */

/**
 * Returns a standard mapping object for columns in the "Hourly + Spiff Pay" sheet.
 * This helps centralize the column definitions used across different functions.
 *
 * @return {Object} An object with keys for common fields (nameColumn, actionColumn, etc.)
 *                  and values representing their 1-based column index and the data start row.
 */
function getRatesSheetMapping() {
  // These indices correspond to the columns in the 'Hourly + Spiff Pay' sheet
  return {
    nameColumn: 1,       // Column A: Technician Name
    positionColumn: 2,   // Column B: Position
    rateColumn: 4,       // Column D: Base Rate (example, might not be used by Spiff directly)
    actionColumn: 7,     // Column G: Action Dropdown
    dataStartRow: 3      // Row number where the actual technician data begins (below headers)
  };
}

/**
 * Resets the "Action" dropdown to "Ready" in the 'Hourly + Spiff Pay' sheet,
 * typically used after an error occurs during processing.
 *
 * @param {Sheet} ratesSheet - The 'Hourly + Spiff Pay' sheet object.
 * @param {number} row - The 1-based row index containing the dropdown.
 * @param {number} col - The 1-based column index containing the dropdown.
 */
function resetActionDropdown(ratesSheet, row, col) {
  if (!ratesSheet || !row || !col) {
    console.warn("resetActionDropdown called with invalid parameters.");
    return;
  }
  try {
    ratesSheet.getRange(row, col).setValue("Ready");
    console.log(`Reset action dropdown to 'Ready' for row ${row}, col ${col}.`);
  } catch(e) {
    console.error(`Failed to reset action dropdown for row ${row}, col ${col}: ${e.message}`);
    // SpreadsheetApp.getUi().alert("Failed to reset status dropdown for row " + row);
  }
}